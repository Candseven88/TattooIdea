<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Share Test</title>
</head>
<body>
    <h1>Share Function Test</h1>
    <button onclick="testShare()">Test Share</button>
    <button onclick="testClipboard()">Test Clipboard</button>
    <div id="result"></div>

    <script>
        async function testShare() {
            const text = `ğŸ¨ Just voted on some amazing tattoo designs on Teaspill! Check out the leaderboard and vote for your favorites! #Teaspill #TattooDesigns #VoteForArt`;
            const url = window.location.href;
            
            try {
                // æ£€æŸ¥æ˜¯å¦æ”¯æŒåŸç”Ÿåˆ†äº«APIï¼ˆä¸»è¦åœ¨ç§»åŠ¨è®¾å¤‡ä¸Šï¼‰
                if (navigator.share && navigator.canShare) {
                    const shareData = {
                        title: 'Teaspill Tattoo Voting',
                        text: text,
                        url: url
                    };
                    
                    // æ£€æŸ¥æ˜¯å¦å¯ä»¥åˆ†äº«è¿™äº›æ•°æ®
                    if (navigator.canShare(shareData)) {
                        await navigator.share(shareData);
                        document.getElementById('result').innerHTML = 'âœ… Native share successful!';
                        return;
                    }
                }
                
                // å¦‚æœä¸æ”¯æŒåŸç”Ÿåˆ†äº«ï¼Œå°è¯•å¤åˆ¶åˆ°å‰ªè´´æ¿
                if (navigator.clipboard && window.isSecureContext) {
                    await navigator.clipboard.writeText(`${text}\n\n${url}`);
                    document.getElementById('result').innerHTML = 'âœ… Share text copied to clipboard!';
                } else {
                    // é™çº§æ–¹æ¡ˆï¼šä½¿ç”¨ä¼ ç»Ÿçš„å¤åˆ¶æ–¹æ³•
                    const textArea = document.createElement('textarea');
                    textArea.value = `${text}\n\n${url}`;
                    document.body.appendChild(textArea);
                    textArea.select();
                    document.execCommand('copy');
                    document.body.removeChild(textArea);
                    document.getElementById('result').innerHTML = 'âœ… Share text copied to clipboard!';
                }
            } catch (error) {
                console.error('Share failed:', error);
                document.getElementById('result').innerHTML = `âŒ Share failed: ${error.message}`;
            }
        }

        async function testClipboard() {
            try {
                if (navigator.clipboard && window.isSecureContext) {
                    await navigator.clipboard.writeText('Test clipboard functionality');
                    document.getElementById('result').innerHTML = 'âœ… Clipboard test successful!';
                } else {
                    document.getElementById('result').innerHTML = 'âŒ Clipboard not supported or not secure context';
                }
            } catch (error) {
                document.getElementById('result').innerHTML = `âŒ Clipboard test failed: ${error.message}`;
            }
        }

        // æ˜¾ç¤ºç¯å¢ƒä¿¡æ¯
        document.getElementById('result').innerHTML = `
            <h3>Environment Info:</h3>
            <p>User Agent: ${navigator.userAgent}</p>
            <p>Secure Context: ${window.isSecureContext}</p>
            <p>Share API: ${navigator.share ? 'Supported' : 'Not supported'}</p>
            <p>Clipboard API: ${navigator.clipboard ? 'Supported' : 'Not supported'}</p>
            <p>Can Share: ${navigator.canShare ? 'Supported' : 'Not supported'}</p>
        `;
    </script>
</body>
</html> 